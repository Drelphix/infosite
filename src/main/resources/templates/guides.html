<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:insert="main::head"></head>
<head>
    <meta charset="UTF-8">
    <title>Инструкции</title>
</head>
<div id="header" th:insert="main::menu"></div>
<div style="padding: 60px 10px 10px 170px;">
    <div class="sidenav">
        <table class="sideweb" style="background-color: initial; text-align: initial;">
            <th th:if="${mode==false}">Выберите тему:</th>
            <th th:if="${mode==true}"><a th:href="@{/guideMenu/new}" style="font-size: initial">Добавить тему</a></th>
            <tbody>
            <tr th:each="menu:${guideMenu}">
                <td th:if="${mode==false}"><a th:href="@{/guideMenu(id=${menu.id})}" th:text="${menu.getName()}"></a></td>
                <td th:if="${mode==true}"><a th:href="@{/guideMenu/edit(id=${menu.id})}" th:text="${menu.getName()}"></a></td>
            </tr>
            </tbody>
        </table>
    </div>

    <center>
        <span th:if="${error}">Невозможно удалить, посколько меню содержит инструкции</span>
        <!--Список гайдов относящихся к меню в таблице-->
            <table class="iksweb">
                <tbody th:if="${currentMenu}">
                <!-- ↑Сюда прописать условие не отображать пока не выбрано ничего-->
                <tr th:unless="${mode==true}">
                <th colspan="6" th:if="${currentMenu}" th:text="${currentMenu.getName()}"></th>
                </tr>
                <tr th:if="${mode==true}">
                    <th colspan="8" th:if="${currentMenu}" th:text="${currentMenu.getName()}"></th>
                </tr>
                </tbody>
                <tbody class="btnm">
                <tr>
                    <th>Название</th>
                    <th>Краткое описание</th>
                    <th>Дата создания</th>
                    <th>Пользователем</th>
                    <th>Дата редактирования</th>
                    <th>Пользователем</th>
                    <th colspan="2" th:if="${mode==true}">Действия</th>
                </tr>
                <tr th:each="guide:${currentMenu.guides}">
                    <td><a th:href="@{/guide(id=${guide.id})}" th:text="${guide.title}"></a></td>
                    <td th:text="${guide.shortDescription}"></td>
                    <td th:text="${guide.date}"></td>
                    <td th:text="${guide.username}"></td>
                    <td th:text="${guide.lastEditDate}"></td>
                    <td th:text="${guide.lastEditUsername}"></td>
                    <td th:if="${mode==true}"><a th:href="@{/guide/edit(id=${guide.id})}">Изменить</a></td>
                    <td th:if="${mode==true}"><a th:href="@{/guide/delete(id=${guide.id})}">Удалить</a></td>
                </tr>
                <tr>
                    <th th:if="${mode==true}"colspan="8"><a href="#" th:href="@{/guide/new(mid=${currentMenu.id})}">Добавить запись</a></th>
                </tr>
                </tbody>
            </table>



        <table class="iksweb" style="width:initial" th:if="${newGuideMenu}">
            <form action="#" method="post" th:object="${newGuideMenu}">
                <tr>
                    <th colspan="2" th:unless="${editGuideMenu}">Добавить пункт меню</th>
                    <th colspan="2" th:if="${editGuideMenu}">Переименовать пункт меню</th>
                </tr>
                <tr>
                    <td>Название меню:</td>
                    <input th:field="*{id}" type="hidden">
                    <input th:field="*{guides}" type="hidden">
                    <td><input maxlength="12" class="edit" required th:field="*{name}" type="text"></td>
                </tr>
                <tr th:if="${error}">
                    <th th:text="${error}"></th>
                </tr>
                <tr>
                    <td colspan="2" th:unless="${editGuideMenu}"><input class="confirm" type="submit" th:formaction="@{/guideMenu/save}" value="Сохранить"></td>
                    <td th:if="${editGuideMenu}"><input class="confirm" type="submit" th:formaction="@{/guideMenu/rename}" value="Переименовать"></td>
                    <td th:if="${editGuideMenu}"><input class="confirm" type="submit" formmethod="get" th:formaction="@{/guideMenu/delete(id=${newGuideMenu.id})}" value="Удалить пункт"></td>
                </tr>
            </form>
        </table>
        </center>

        <div th:if="${currentGuide}">
            <h1 th:text="${currentGuide.title}"></h1>
            <span>Created by
            <span th:text="${currentGuide.username}"></span> at
            <span th:text="${currentGuide.date}"></span>
            </span>
            <input th:field="${currentGuide.id}" type="hidden">

            <span th:if="${currentGuide.lastEditDate}">Last edited by
			<span th:text="${currentGuide.lastEditUsername}"></span> at
			<span th:text="${currentGuide.lastEditDate}"></span>
			</span>
            <div th:utext="${currentGuide.text}"></div>

            <td th:if="${mode==true}">
                <a class="link" th:href="@{/guide/delete(id=${currentGuide.id})}">Удалить инструкцию</a>
            </td>
        </div>
        </tr>

    </table>

</div>
</body>
</html>