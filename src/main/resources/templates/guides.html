<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:insert="main::head"></head>
<head>
    <meta charset="UTF-8">
    <title>Инструкции</title>
</head>
<div id="header" th:insert="main::menu"></div>
<div style="padding: 40px 10px 10px 10px;">
    <br>
    <table class="guide">
        <tr class="none">
        <tr class="widget-title">Выберите тему:</tr><!--Хз как ещё назвать-->
        <tr class="widget-list" th:each="menu:${guideMenu}">
            <td th:if="${mode==false}"><a th:href="@{/guideMenu(id=${menu.id})}" th:text="${menu.getName()}"></a></td>
            <td th:if="${mode==true}"><a th:href="@{/guideMenu/edit(id=${menu.id})}" th:text="${menu.getName()}"></a>
            </td>
        </tr>
        <tr th:if="${mode==true}"><a th:href="@{/guideMenu/new}">Добавить тему</a></tr>
        </tr>
        <!--Список гайдов относящихся к меню в таблице-->
        <td th:if="${currentMenu}">
            <h1 th:text="${currentMenu.getName()}"></h1>
            <table class="btnm">
                <tr th:each="guide:${currentMenu.guides}">
                    <td><a th:href="@{/guide(id=${guide.id})}" th:text="${guide.title}"></a></td>
                    <td th:text="${guide.shortDescription}"></td>
                    <td th:text="${guide.date}"></td>
                    <td th:text="${guide.username}"></td>
                    <td th:text="${guide.lastEditDate}"></td><!--Назвать поле, например, изменено, общее название мб?-->
                    <td th:text="${guide.lastEditUsername}"></td>
                </tr>
            </table>
        </td>
        <!--Полное отображение инструкции-->
        <td th:if="${newGuideMenu}">
            <form method="post" th:object="${newGuideMenu}">
                <a th:text="${error}"></a>
                <a>Название меню</a>
                <input th:field="*{id}" type="hidden">
                <input required th:field="*{name}" type="text">
                <input th:field="*{guides}" type="hidden">
                <button class="button_success" th:formaction="@{/guideMenu/save}" th:unless="${editGuideMenu}">
                    Сохранить
                </button>
                <button class="button_success" th:formaction="@{/guideMenu/rename}" th:if="${editGuideMenu}">
                    Переименовать
                </button>
                <a th:href="@{/guideMenu/delete(id=${newGuideMenu.id})}" th:if="${editGuideMenu}">Удалить пункт</a>
            </form>
        </td>

        <div th:if="${currentGuide}">
            <h1 th:text="${currentGuide.title}"></h1>
            <span>Created by
            <span th:text="${currentGuide.username}"></span> at
            <span th:text="${currentGuide.date}"></span>
            </span>
            <input th:field="${currentGuide.id}" type="hidden">

            <span th:if="${currentGuide.lastEditDate}">Last edited by
			<span th:text="${currentGuide.lastEditUsername}"></span> at
			<span th:text="${currentGuide.lastEditDate}"></span>
			</span>
            <div th:utext="${currentGuide.text}"></div>

            <td th:if="${mode==true}">
        <a class="link" th:href="@{/guide/delete(id=${currentGuide.id})}">Удалить инструкцию</a>
    </td>
</div>
</tr>

    </table>

</div>
</body>
</html>