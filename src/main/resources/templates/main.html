<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:fragment="head">
    <link href="#" rel="stylesheet" th:href="@{/css/main.css}"/>
    <link href="#" rel="stylesheet" th:href="@{/css/tables.css}"/>
    <link href="#" rel="stylesheet" th:href="@{/css/login.css}"/>
    <link href="#" rel="stylesheet" th:href="@{/css/guide.css}"/>
    <link href="#" rel="stylesheet" th:href="@{/css/fontawesome.min.css}"/>
    <link href="#" rel="stylesheet" th:href="@{/css/all.css}"/>
    <meta charset="UTF-8">
    <title>InfoSite</title>
</head>
<body>
<div th:fragment="menu">
    <header>
        <div>
            <div class="d-flex" style="height: 45px;">
                <div class="logo" style="height: 40px;">
                    <a href="#" th:href="@{/}"><img alt="" src="https://auto1.by/img/svg/logo.svg" style="height:35px"
                                                    title=""/></a>
                    <a class="link" href="#" th:href="@{/logout}"><span style="color:white"
                                                                        th:text="'Welcome, '+${#authentication.name}"></span></a>
                </div>
                <nav th:if="${menus}">
                    <ul class="topmenu" th:if="${#strings.contains(#authentication.principal.authorities,'admin')}">
                        <li th:each="xml : ${xmls}">
                            <a th:text="${xml.name}"></a>
                            <ul class="submenu" th:if="${not #lists.isEmpty(xml.subs)}">
                                <li th:each="sub,itemStat: ${xml.subs}">
                                    <a href="" th:href="@{'/xml/'+${xml.name}(id=${itemStat.index})}"
                                       th:text="${sub}"></a>
                                </li>
                            </ul>
                        </li>
                        <li th:each="menu : ${menus}">
                            <a href="#" th:href="@{/menu/edit(id=${menu.idMenu})}" th:if="${mode==true}"
                               th:text="${menu.name}"></a>
                            <a th:if="${mode!=true}" th:text="${menu.name}"></a>
                            <ul class="submenu" th:if="${not #lists.isEmpty(menu.subMenuSet)}">
                                <li th:each="sub: ${menu.subMenuSet}">
                                    <a href="" th:href="@{/show(id=${sub.idSubMenu})}"
                                       th:text="${sub.name}"></a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a class="menu" href="#" th:href="@{/guides}">Гайды</a>
                        </li>
                        <li>
                            <a class="menu" href="#" th:href="@{/management}">Управление</a>
                        </li>
                        <li>
                            <a class="menu" href="#" th:href="@{/orders}">Заявки</a>
                        </li>
                        <li th:if="${mode==true}">
                            <a href="#" th:href="@{/menu/add}"><img alt="Добавить пункт меню"
                                                                    src="#"
                                                                    th:src="@{/images/addnew.png}"
                                                                    title=""/></a>
                        </li>
                        <li th:if="${mode==false}">
                            <a href="#" th:href="@{/mode(mode=${!mode})}"><img
                                    alt="Перейти в режим редактирования" src="#" th:src="@{/images/gear.png}" title=""/></a>
                        </li>
                        <li th:if="${mode==true}">
                            <a href="#" th:href="@{/mode(mode=${!mode})}"><img
                                    alt="Перейти в режим просмотра" src="#" th:src="@{/images/show.png}" title=""/></a>
                        </li>
                        <li>
                            <a href="#" th:href="@{/export}"><img alt="" src="#" th:src="@{/images/excel.png}"
                                                                  title=""/></a>
                        </li>


                    </ul>
                </nav>
            </div>
        </div>
    </header>
</div>
<div th:if="${#strings.contains(#authentication.principal.authorities,'admin')}">
    <div class="tables" style="margin-top:20px;" th:each="table,tabRow: ${tables}" th:if="${tables}">
        <center>
            <h3><a class="link" href="#" th:href="@{/table/edit(tab=${table.id})}" th:if="${mode==true}"
                   th:text="${table.name}"></a></h3>
            <h3 th:if="${mode==false}" th:text="${table.name}"></h3>            <table align="center" border="1" class="info" th:if="${not #lists.isEmpty(table.cols)}">
                <tbody th:if="${not #lists.isEmpty(table.cols)}">
                <tr class="line">
                    <th class="cell" th:each="col: ${table.cols}"><span th:text="${col.name}"></span></th>
                    <th th:if="${mode==true}"><span>Действие</span></th>
                </tr>
            <tr class="line" th:each="lineList, row: ${table.lines}">
                <td class="cell" th:each="line:${lineList}" th:switch="${line.hidden}">
                    <!--Отображение обычного поля -->
                    <div th:case="false">
                        <a class="link" href="#" th:href="@{/edit(tab=${table.id},line=${row.index})}"
                           th:if="${mode==true}"
                           th:text="${line.data}"></a>
                        <span th:if="${mode==false}" th:text="${line.data}"></span>
                    </div>
                    <!--Отображение скрытого поля Не работает -->
                    <div th:case="true">
                        <input disabled th:id="pass+${row.index}" th:value="${line.data}" type="password">
                        <input onclick="getData(this.getAttribute('data1'))" th:data1="${line.data}" type="button">
                    </div>
                </td>

                <td class="delLine" th:if="${mode==true}">
                    <a class="link" href="#" th:href="@{/delLine(tab=${table.id},line=${row.index})}">Удалить строку</a>
                </td>
            </tr>
            </tbody>
        </table>
    </center>
    <center th:if="${not #lists.isEmpty(table.cols)}">
        <a align="center" class="link" href="#" th:href="@{/addLine(tab=${table.id})}" th:if="${mode==true}">Добавить
            строку</a>
    </center>
</div>
    <div align="center" style="padding-top:5px" th:if="${submenu}">
        <a class="link" href="#" th:href="@{/table/new(id=${submenu})}" th:if="${mode==true}">Добавить таблицу</a>
    </div>
</div>
</body>

</html>